---
interface Webcam {
  name: string;
  region: string;
  description: string;
  url: string;
  type: 'network' | 'single';
}

const webcams: Webcam[] = [
  {
    name: 'AlertCalifornia Network',
    region: 'all',
    description: '500+ webcams statewide with interactive map showing angle of view',
    url: 'https://ops.alertcalifornia.org/cameras',
    type: 'network'
  },
  {
    name: 'Yosemite Webcams',
    region: 'north',
    description: 'Multiple park webcams with hourly screenshots',
    url: 'https://www.nps.gov/yose/learn/photosmultimedia/webcams.htm',
    type: 'network'
  },
  {
    name: 'SEKI Webcams',
    region: 'central',
    description: 'Sequoia & Kings Canyon park webcams',
    url: 'https://www.nps.gov/seki/learn/photosmultimedia/webcams.htm',
    type: 'network'
  },
  {
    name: 'Mammoth Mountain',
    region: 'eastern',
    description: 'Live webcams from The Summit and around the mountain',
    url: 'https://www.mammothmountain.com/on-the-mountain/mammoth-webcam/the-summit',
    type: 'network'
  },
  {
    name: 'Mono County Webcams',
    region: 'eastern',
    description: 'Multiple eastside webcams throughout Mono County',
    url: 'https://www.monocounty.org/plan-your-trip/weather-and-road-conditions/webcams-in-mono-county/',
    type: 'network'
  },
  {
    name: 'Owens Valley Webcams',
    region: 'eastern',
    description: 'Great Basin Air Pollution Control District webcam network',
    url: 'https://www.gbuapcd.org/cgi-bin/cameraViewer',
    type: 'network'
  },
  {
    name: 'Bishop Weather - Mt. Humphreys',
    region: 'eastern',
    description: 'View of Mt. Humphreys, Basin Mountain, and Mt. Tom from Bishop',
    url: 'http://bishopweather.com',
    type: 'single'
  },
  {
    name: 'Whitney Portal',
    region: 'eastern',
    description: 'Zoomed view of Mt. Whitney',
    url: 'http://www.mountwhitneyforum.com/webcam/camera1.jpg',
    type: 'single'
  }
];

const regions = [
  { id: 'all', name: 'All Regions' },
  { id: 'north', name: 'North Sierra' },
  { id: 'central', name: 'Central Sierra' },
  { id: 'eastern', name: 'Eastern Sierra' }
];
---

<div class="webcam-gallery">
  <div class="webcam-intro">
    <p>
      <strong>Webcam resources:</strong> Check visibility and current conditions across the Sierra Nevada.
      AlertCalifornia offers the most comprehensive network with 500+ cameras and interactive maps.
    </p>
  </div>

  <div class="webcam-filters">
    <label for="region-filter">Filter by region:</label>
    <select id="region-filter" class="region-select">
      {regions.map(region => (
        <option value={region.id}>{region.name}</option>
      ))}
    </select>
  </div>

  <div class="webcam-grid">
    {webcams.map(webcam => (
      <div class="webcam-card" data-region={webcam.region}>
        <div class="webcam-card-header">
          <h3>{webcam.name}</h3>
          {webcam.type === 'network' && (
            <span class="badge badge-network">Multiple Cams</span>
          )}
          {webcam.type === 'single' && (
            <span class="badge badge-single">Single Cam</span>
          )}
        </div>
        <p class="webcam-description">{webcam.description}</p>
        <div class="webcam-region-tag">
          <small>
            {webcam.region === 'all' ? 'Statewide' :
             webcam.region === 'north' ? 'North Sierra' :
             webcam.region === 'central' ? 'Central Sierra' :
             'Eastern Sierra'}
          </small>
        </div>
        <a href={webcam.url} target="_blank" rel="noopener noreferrer" class="webcam-link">
          View Webcams â†’
        </a>
      </div>
    ))}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const filterSelect = document.getElementById('region-filter') as HTMLSelectElement;
    const webcamCards = document.querySelectorAll('.webcam-card');

    if (filterSelect) {
      filterSelect.addEventListener('change', (e) => {
        const selectedRegion = (e.target as HTMLSelectElement).value;

        webcamCards.forEach(card => {
          const cardElement = card as HTMLElement;
          const cardRegion = cardElement.getAttribute('data-region');

          if (selectedRegion === 'all' || cardRegion === 'all' || cardRegion === selectedRegion) {
            cardElement.style.display = 'block';
          } else {
            cardElement.style.display = 'none';
          }
        });
      });
    }
  });
</script>

<style>
  .webcam-gallery {
    margin: 2rem 0;
  }

  .webcam-intro {
    background-color: color-mix(in srgb, var(--primary) 10%, transparent);
    border-left: 4px solid var(--primary);
    padding: 1rem 1.25rem;
    border-radius: var(--pico-border-radius);
    margin-bottom: 1.5rem;
  }

  .webcam-intro p {
    margin: 0;
  }

  .webcam-filters {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .webcam-filters label {
    font-weight: 600;
    margin: 0;
  }

  .region-select {
    max-width: 250px;
  }

  .webcam-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.25rem;
  }

  .webcam-card {
    background-color: var(--pico-secondary-background);
    border: 1px solid var(--border-color);
    border-radius: var(--pico-border-radius);
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    transition: all 0.2s ease;
  }

  .webcam-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-color: var(--primary);
  }

  .webcam-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .webcam-card h3 {
    margin: 0;
    font-size: 1.125rem;
    color: var(--pico-color);
  }

  .badge {
    display: inline-block;
    padding: 0.25rem 0.625rem;
    border-radius: var(--pico-border-radius);
    font-size: 0.75rem;
    font-weight: 600;
    white-space: nowrap;
  }

  .badge-network {
    background-color: color-mix(in srgb, var(--primary) 20%, transparent);
    color: var(--primary);
  }

  .badge-single {
    background-color: var(--pico-muted-color);
    color: var(--pico-background-color);
    opacity: 0.7;
  }

  .webcam-description {
    color: var(--pico-muted-color);
    font-size: 0.9375rem;
    margin: 0 0 1rem 0;
    flex: 1;
  }

  .webcam-region-tag {
    margin-bottom: 0.75rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border-color);
  }

  .webcam-region-tag small {
    color: var(--pico-muted-color);
    text-transform: uppercase;
    font-weight: 600;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
  }

  .webcam-link {
    display: inline-block;
    padding: 0.625rem 1rem;
    background-color: var(--primary);
    color: white;
    text-decoration: none;
    border-radius: var(--pico-border-radius);
    font-weight: 500;
    text-align: center;
    transition: background-color 0.2s ease;
  }

  .webcam-link:hover {
    background-color: var(--primary-hover);
    color: white;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .webcam-grid {
      grid-template-columns: 1fr;
    }

    .webcam-filters {
      flex-direction: column;
      align-items: flex-start;
    }

    .region-select {
      max-width: 100%;
      width: 100%;
    }
  }
</style>
